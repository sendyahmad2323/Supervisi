{% extends 'base.html' %}
{% block title %}
  Daftar Supervisi
{% endblock %}
{% block pagetitle %}
  <i class="fa-solid fa-clipboard-check me-2"></i>Daftar Supervisi Keperawatan
{% endblock %}

{% block content %}
  <style>
    /* === scoped styles: konsisten dengan base === */
    .card-soft {
      background: #fff;
      border: 1px solid rgba(13, 110, 253, 0.08);
      border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(13, 110, 253, 0.06);
    }
    .hero {
      background: linear-gradient(145deg, rgba(13, 110, 253, 0.18), rgba(13, 110, 253, 0.08));
      border: 1px solid rgba(13, 110, 253, 0.12);
      border-radius: var(--radius);
      box-shadow: 0 12px 28px rgba(13, 110, 253, 0.08);
      padding: 18px;
    }
    .table thead th {
      background: linear-gradient(145deg, #0d6efd, #2563eb);
      color: #fff;
      font-weight: 700;
      border: 0;
      text-align: center;
    }
    .table tbody td {
      vertical-align: middle;
    }
    .table-hover tbody tr:hover {
      background: rgba(13, 110, 253, 0.05);
    }
    .badge {
      font-size: 0.8rem;
      border-radius: 999px;
      padding: 0.35em 0.7em;
    }
    .id-pill {
      background: #0d6efd;
      color: #fff;
      border-radius: 999px;
      padding: 0.25rem 0.55rem;
      font-weight: 800;
    }
    .avatar-pill {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(13, 110, 253, 0.12);
      color: #0d6efd;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .btn-soft {
      border-radius: 12px;
      font-weight: 700;
      box-shadow: 0 6px 16px rgba(13, 110, 253, 0.15);
    }
  </style>

  <!-- Header -->
  <div class="hero mb-3">
    <h5 class="fw-bold mb-1"><i class="fa-solid fa-list-check me-2 text-primary"></i>Daftar Supervisi Keperawatan</h5>
    <div class="text-muted small">Monitoring dan evaluasi kinerja perawat</div>
  </div>

  <!-- Tabel -->
  <div class="card-soft">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0 text-center">
        <thead>
          <tr>
            <th style="width:80px;">No</th>
            <th>
              <i class="fa-solid fa-user-nurse me-1"></i>Perawat
            </th>
            <th>
              <i class="fa-solid fa-file-lines me-1"></i>Format
            </th>
            <th style="width:180px;">
              <i class="fa-solid fa-chart-simple me-1"></i>Skor
            </th>
            <th style="width:160px;">
              <i class="fa-solid fa-pen-nib me-1"></i>Tanda Tangan
            </th>
            <th style="width:240px;">
              <i class="fa-solid fa-gear me-1"></i>Aksi
            </th>
          </tr>
        </thead>
        <tbody>
          {% for s in supervisi %}
            <tr>
              <!-- ID -->
              <td>
                <span class="id-pill">{{ forloop.counter }}</span>
              </td>

              <!-- Perawat -->
              <td class="text-start">
                <div class="d-flex align-items-center gap-2">
                  <div class="avatar-pill">
                    <i class="fa-solid fa-user"></i>
                  </div>
                  <span class="fw-semibold">{{ s.perawat.username }}</span>
                </div>
              </td>

              <!-- Format -->
              <td class="text-start">{{ s.format_supervisi.nama }}</td>

              <!-- Skor + progress -->
              <td>
                <div class="d-flex align-items-center justify-content-center gap-2">
                  <strong>{{ s.skor_total|floatformat:1 }}%</strong>
                  <div class="progress flex-grow-1" style="height:8px; max-width:100px;">
                    <div class="progress-bar bg-info" role="progressbar" style="width: {{ s.skor_total }}%;"></div>
                  </div>
                </div>
              </td>

              <!-- Status TTD -->
              <td>
                {% if s.ttd_perawat and s.ttd_kepala %}
                  <span class="badge bg-success"><i class="fa-solid fa-check me-1"></i>Lengkap</span>
                {% elif s.ttd_perawat %}
                  <span class="badge bg-info text-dark"><i class="fa-solid fa-user-check me-1"></i>Perawat</span>
                {% elif s.ttd_kepala %}
                  <span class="badge bg-primary"><i class="fa-solid fa-user-tie me-1"></i>Kepala</span>
                {% else %}
                  <span class="badge bg-warning text-dark"><i class="fa-solid fa-clock me-1"></i>Belum</span>
                {% endif %}
              </td>

              <!-- Aksi -->
              <td>
                <div class="d-flex justify-content-center gap-2 flex-wrap">
                  <a href="{% url 'detail_supervisi' s.id %}" class="btn btn-sm btn-primary btn-soft"><i class="fa-solid fa-eye me-1"></i>Detail</a>
                  <a href="{% url 'hapus_supervisi' s.id %}" class="btn btn-sm btn-danger btn-soft" onclick="return confirm('Yakin ingin menghapus supervisi ini?');"><i class="fa-solid fa-trash me-1"></i>Hapus</a>
                </div>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="6" class="py-5 text-muted">
                <i class="fa-regular fa-rectangle-list fa-2xl d-block mb-2"></i>
                Belum ada data supervisi
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
